(* scheduling-ops.def
 *
 * COPYRIGHT (c) 2008 The Manticore Project (http://manticore.cs.uchicago.edu)
 * All rights reserved.
 *
 * This file contains prototypes scheduling operations.
 *)

#ifndef _SCHEDULING_OPS_DEF_
#define _SCHEDULING_OPS_DEF_

(* control transfers *)
define @atomic-yield (vp : vproc / exh : exh) : unit;
define @yield (vp : vproc / exh : exh) : unit;
define inline @thread-exit ( / exh : exh) noreturn;
define inline @exit (_ : unit / exh : exh) : any;
define inline @dispatch (vp : vproc / exh : exh) noreturn;
define @dispatch-action (act : sigact, dst : vproc / exh : exh) : ();
define inline @spawn-on (f : fun (unit / exh -> unit), fgs : fgs, dst : vproc / exh : exh) : ();

(* scheduler initialization *)
define @scheduler-hook (vps : list / exh : exh) : ();
define @scheduler-startup (mkAct : fun (vproc / exh -> sigact), fgs : fgs, vps : list / exh : exh) : ();
define @default-scheduler-startup ( / exh : exh) : ();
define @work-stealers-startup ( / exh : exh) : ();

(* process creation *)
define inline @fiber (f : fiber_fun / exh : exh) : fiber;
define inline @spawn (f : fiber_fun / exh : exh) : fgs;

#endif /* !_SCHEDULING_OPS_DEF_ */
