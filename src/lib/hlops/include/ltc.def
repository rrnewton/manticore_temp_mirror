(* ltc.def
 *
 * COPYRIGHT (c) 2007 The Manticore Project (http://manticore.cs.uchicago.edu)
 * All rights reserved.
 *
 * Lazy task creation.
 *)

#include "the.def"
#include "tags.def"
#include "ivar.def"

#ifndef _LTC_DEF_
#define _LTC_DEF_

typedef ltq_fun = fun (/exh -> the_deque);

define @ltc-scheduler ( / exh : exh) : ltq_fun;
define inline @ltc-pop(arg : unit / exh : exh) : any;
define inline @ltc-push(f : fiber_fun / exh : exh) : unit;
define inline @ltc-push-fiber(k : fiber / exh : exh) : unit;
define inline @ltc-ivar-put (arg : [ivar, any] / exh : exh) : unit;

(* experimentation *)
define @ltc-ivar-get (ivar : ivar, c : cancel_cell / exh : exh) : any;
define inline @ltc-wait-for-all(_ : unit / exh : exh) : unit;
define @promote-only(f : fiber_fun / exh : exh) : unit;

#endif /*!  _LTC_DEF_ */
