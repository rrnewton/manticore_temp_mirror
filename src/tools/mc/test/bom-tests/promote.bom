(* promote.bom *)

module Promote

  extern void M_AssertNotLocalPtr (void *);

  fun init (i : int/ exh : cont(any)) : int =

    let x:[int] = alloc(123)

    cont k () = 
       do ccall M_AssertNotLocalPtr (x)
       return (0)

    let k :cont() = promote (k)
    throw k ()
